# Toora monorepo â€” Railway service configuration
# Each [[services]] block maps to a service in Railway by name.
# Railway reads this file and applies config per matched service name.

[[services]]
name = "Toora"

[services.build]
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[services.deploy]
preDeployCommand = "alembic upgrade head"
startCommand = "sh -c \"uvicorn backend.main:app --host 0.0.0.0 --port $PORT\""
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[[services]]
name = "web"

[services.build]
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[services.deploy]
startCommand = "sh -c \"uvicorn backend.main:app --host 0.0.0.0 --port $PORT\""
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[[services]]
name = "worker"

[services.build]
builder = "dockerfile"
dockerfilePath = "Dockerfile.worker"

[services.deploy]
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[[services]]
name = "bot"

[services.build]
builder = "dockerfile"
dockerfilePath = "Dockerfile.bot"

[services.deploy]
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[[services]]
name = "frontend"

[services.build]
builder = "dockerfile"
dockerfilePath = "frontend.Dockerfile"

[services.deploy]
startCommand = "node server.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
